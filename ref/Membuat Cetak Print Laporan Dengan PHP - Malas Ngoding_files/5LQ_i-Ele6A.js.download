if (self.CavalryLogger) { CavalryLogger.start_js(["MDBZ4"]); }

__d("RelayRTIUtils",["invariant","Promise","ActorURI","CSRFGuard","CurrentLocale","CurrentUser","RelayAPIConfig","XHRRequest","getAsyncParams","getCrossOriginTransport","md5"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(a){return a.split("/").reverse()[1]}function a(a,c,d,e,f){__p&&__p();if(d!=null&&f!=null){var i={locale:b("CurrentLocale").get(),queryID:d,serializedQueryParameters:JSON.stringify(e),viewerID:b("CurrentUser").getID(),useOSSResponseFormat:!0};return b("Promise").resolve({topic:f,transformContext:i,useCase:h(f)})}c!=null||d!=null||g(0,271);return new(b("Promise"))(function(f,g){__p&&__p();var i;i=babelHelpers["extends"]((i={},i[b("ActorURI").PARAMETER_ACTOR]=b("RelayAPIConfig").actorID,i.query_params=JSON.stringify(e),i),b("getAsyncParams")("POST"));d!=null&&(i.doc_id=d);c!=null&&(i.query=c);i=new(b("XHRRequest"))(a).setTransportBuilder(b("getCrossOriginTransport").withCredentials).setMethod("POST").setData(i).setErrorHandler(function(a){g(new Error("getTopicAndTransformContext: Unable to retrieve topicID for subscription. HTTP Error ["+a.errorCode+"] "+a.errorType+" "+a.errorMsg))}).setResponseHandler(function(a){try{var c=JSON.parse(b("CSRFGuard").clean(a)),d=c.payload.topic||c.payload.payload.topic;f({topic:d,transformContext:JSON.parse(c.payload.transform_context||c.payload.payload.transform_context),useCase:h(d)})}catch(b){g(new Error("getTopicAndTransformContext: encountered error "+b+" during "+("parsing, raw response is \n"+a)))}});i.send()})}function c(a,c){c=Object.assign({},c);delete c.client_subscription_id;c=(JSON.stringify(c).match(/[a-zA-Z0-9\-_]+/g)||[]).concat(a).sort().join(":");return b("md5")(c)}e.exports={extractUseCaseFromTopic:h,getTopicAndTransformContext:a,computeRoutingHint:c}}),null);